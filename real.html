<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sports Schedule Hub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .control-group {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-item label {
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
        }

        .sport-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sport-btn {
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .sport-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .sport-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .date-input {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            background: white;
            transition: border-color 0.3s ease;
        }

        .date-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .fetch-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .fetch-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
        }

        .fetch-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2rem;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            background: rgba(245, 101, 101, 0.1);
            border: 1px solid #f56565;
            color: #c53030;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .schedule-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .schedule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .schedule-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2d3748;
        }

        .schedule-date {
            color: #718096;
            font-weight: 500;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .game-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .game-time {
            font-size: 0.9rem;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .team-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .team-record {
            font-size: 0.85rem;
            color: #718096;
        }

        .vs {
            font-size: 1.2rem;
            font-weight: 600;
            color: #a0aec0;
            margin: 0 15px;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #718096;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }

        .betting-info {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .no-games {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .no-games-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* Golf-specific styles */
        .golf-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
        }

        .tournament-name {
            font-weight: 700;
            font-size: 1.2rem;
            color: #2d3748;
            margin-bottom: 8px;
            text-align: center;
        }

        .tournament-location {
            color: #718096;
            font-size: 0.9rem;
            text-align: center;
            margin-bottom: 15px;
        }

        .tournament-dates {
            background: rgba(102, 126, 234, 0.1);
            padding: 8px 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.85rem;
            color: #667eea;
            font-weight: 600;
        }

        .tournament-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
            font-size: 0.85rem;
            color: #718096;
        }

        .purse-info {
            font-weight: 600;
            color: #48bb78;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .sport-buttons {
                justify-content: center;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .schedule-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ Sports Schedule Hub</h1>
            <p>Your ultimate destination for live sports schedules</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="control-item">
                    <label>Select Sport</label>
                    <div class="sport-buttons">
                        <button class="sport-btn active" data-sport="mlb">‚öæ MLB</button>
                        <button class="sport-btn" data-sport="nfl">üèà NFL</button>
                        <button class="sport-btn" data-sport="wnba">üèÄ WNBA</button>
                        <button class="sport-btn" data-sport="ufc">ü•ä UFC</button>
                        <button class="sport-btn" data-sport="golf">‚õ≥ Golf</button>
                    </div>
                </div>
                
                <div class="control-item">
                    <label for="dateInput">Select Date</label>
                    <input type="date" id="dateInput" class="date-input">
                </div>
                
                <div class="control-item">
                    <label>&nbsp;</label>
                    <button id="fetchBtn" class="fetch-btn">üìÖ Get Schedule</button>
                </div>
            </div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <div>Loading schedule...</div>
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <div id="scheduleContainer" class="schedule-container" style="display: none;">
            <div class="schedule-header">
                <div class="schedule-title" id="scheduleTitle"></div>
                <div class="schedule-date" id="scheduleDate"></div>
            </div>
            <div id="gamesGrid" class="games-grid"></div>
        </div>
    </div>

    <script>
        let currentSport = 'mlb';
        const API_BASE = 'https://schedule.tommyek67.workers.dev/';

        // Set default date to today
        document.getElementById('dateInput').valueAsDate = new Date();

        // Sport button handlers
        document.querySelectorAll('.sport-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.sport-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentSport = btn.dataset.sport;
            });
        });

        // Fetch button handler
        document.getElementById('fetchBtn').addEventListener('click', fetchSchedule);

        // Enter key handler for date input
        document.getElementById('dateInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') fetchSchedule();
        });

        async function fetchSchedule() {
            const dateInput = document.getElementById('dateInput');
            const selectedDate = dateInput.value;
            
            if (!selectedDate) {
                showError('Please select a date');
                return;
            }

            showLoading(true);
            hideError();
            hideSchedule();

            try {
                let data;
                
                if (currentSport === 'golf') {
                    data = await fetchGolfSchedule(selectedDate);
                } else {
                    const url = `${API_BASE}?sport=${currentSport}&day=${selectedDate}`;
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`Failed to fetch: ${response.status} ${response.statusText}`);
                    }

                    data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error);
                    }
                }

                displaySchedule(data, selectedDate);
            } catch (error) {
                console.error('Fetch error:', error);
                showError(`Failed to load schedule: ${error.message}`);
            } finally {
                showLoading(false);
            }
        }

        async function fetchGolfSchedule(selectedDate) {
            try {
                // Use a CORS proxy to fetch the PGA Tour schedule
                const proxyUrl = 'https://api.allorigins.win/get?url=';
                const targetUrl = encodeURIComponent('https://www.pgatour.com/schedule');
                
                const response = await fetch(proxyUrl + targetUrl);
                const data = await response.json();
                
                if (!data.contents) {
                    throw new Error('Failed to fetch PGA Tour data');
                }

                // Parse the HTML content to extract tournament information
                const htmlContent = data.contents;
                const tournaments = parseGolfSchedule(htmlContent, selectedDate);
                
                return {
                    content: {
                        games: tournaments
                    }
                };
            } catch (error) {
                // Fallback to mock data if scraping fails
                console.warn('Golf scraping failed, using fallback data:', error);
                return {
                    content: {
                        games: [
                            {
                                tournamentName: "PGA Tour Event",
                                location: "TBD",
                                startDate: selectedDate,
                                endDate: selectedDate,
                                purse: "TBD",
                                status: "scheduled"
                            }
                        ]
                    }
                };
            }
        }

        function parseGolfSchedule(htmlContent, targetDate) {
            // Create a temporary DOM element to parse the HTML
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');
            
            const tournaments = [];
            const targetDateObj = new Date(targetDate);
            
            try {
                // Look for tournament schedule elements (this is a simplified parser)
                // The actual selectors would need to be updated based on PGA Tour's current HTML structure
                const tournamentElements = doc.querySelectorAll('[data-tournament], .tournament-card, .schedule-item');
                
                tournamentElements.forEach(element => {
                    try {
                        const tournamentName = element.querySelector('.tournament-name, .event-name, h3, h4')?.textContent?.trim();
                        const location = element.querySelector('.location, .venue, .course-name')?.textContent?.trim();
                        const dateText = element.querySelector('.date, .tournament-date, .event-date')?.textContent?.trim();
                        const purse = element.querySelector('.purse, .prize-money')?.textContent?.trim();
                        
                        if (tournamentName) {
                            tournaments.push({
                                tournamentName: tournamentName,
                                location: location || 'TBD',
                                startDate: targetDate,
                                endDate: targetDate,
                                purse: purse || 'TBD',
                                status: 'scheduled',
                                dateText: dateText
                            });
                        }
                    } catch (e) {
                        console.warn('Error parsing tournament element:', e);
                    }
                });
                
                // If no tournaments found, create a generic entry
                if (tournaments.length === 0) {
                    tournaments.push({
                        tournamentName: "Check PGA Tour Website",
                        location: "Visit pgatour.com for complete schedule",
                        startDate: targetDate,
                        endDate: targetDate,
                        purse: "Various",
                        status: "scheduled"
                    });
                }
                
            } catch (error) {
                console.warn('Error parsing golf schedule:', error);
            }
            
            return tournaments;
        }

        function displaySchedule(data, date) {
            const container = document.getElementById('scheduleContainer');
            const title = document.getElementById('scheduleTitle');
            const dateElement = document.getElementById('scheduleDate');
            const gamesGrid = document.getElementById('gamesGrid');

            const sportNames = {
                mlb: 'Major League Baseball',
                nfl: 'National Football League',
                wnba: 'Women\'s National Basketball Association',
                ufc: 'Ultimate Fighting Championship',
                golf: 'PGA Tour Golf'
            };

            title.textContent = sportNames[currentSport] || currentSport.toUpperCase();
            dateElement.textContent = formatDate(date);

            if (!data.content?.games || data.content.games.length === 0) {
                gamesGrid.innerHTML = `
                    <div class="no-games">
                        <div class="no-games-icon">üìÖ</div>
                        <h3>No events scheduled</h3>
                        <p>There are no ${sportNames[currentSport]} events scheduled for this date.</p>
                        ${currentSport === 'golf' ? '<p><a href="https://www.pgatour.com/schedule" target="_blank">Visit PGA Tour website for complete schedule</a></p>' : ''}
                    </div>
                `;
            } else {
                if (currentSport === 'golf') {
                    gamesGrid.innerHTML = data.content.games.map(tournament => createGolfCard(tournament)).join('');
                } else {
                    gamesGrid.innerHTML = data.content.games.map(game => createGameCard(game)).join('');
                }
            }

            container.style.display = 'block';
        }

        function createGolfCard(tournament) {
            return `
                <div class="game-card golf-card">
                    <div class="tournament-name">${tournament.tournamentName}</div>
                    <div class="tournament-location">${tournament.location}</div>
                    <div class="tournament-dates">
                        ${formatGolfDate(tournament.startDate)} ${tournament.startDate !== tournament.endDate ? '- ' + formatGolfDate(tournament.endDate) : ''}
                    </div>
                    <div class="tournament-info">
                        <div class="purse-info">Purse: ${tournament.purse}</div>
                        <div>Status: ${tournament.status.charAt(0).toUpperCase() + tournament.status.slice(1)}</div>
                    </div>
                </div>
            `;
        }

        function createGameCard(game) {
            const gameTime = formatTime(game.dateTime);
            const homeTeam = game.homeTeam || {};
            const awayTeam = game.awayTeam || {};
            
            return `
                <div class="game-card">
                    <div class="game-time">${gameTime}</div>
                    <div class="teams">
                        <div class="team">
                            <div class="team-name">${awayTeam.displayName || awayTeam.name || 'Away Team'}</div>
                            <div class="team-record">${game.awayScoreDisplay || 'TBD'}</div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="team">
                            <div class="team-name">${homeTeam.displayName || homeTeam.name || 'Home Team'}</div>
                            <div class="team-record">${game.homeScoreDisplay || 'TBD'}</div>
                        </div>
                    </div>
                    ${createGameInfo(game)}
                </div>
            `;
        }

        function createGameInfo(game) {
            const info = [];
            
            if (game.overUnder) {
                info.push(`O/U: ${game.overUnder}`);
            }
            
            if (game.homeMoneyline || game.awayMoneyline) {
                const homeML = game.homeMoneyline ? (game.homeMoneyline > 0 ? `+${game.homeMoneyline}` : game.homeMoneyline) : '-';
                const awayML = game.awayMoneyline ? (game.awayMoneyline > 0 ? `+${game.awayMoneyline}` : game.awayMoneyline) : '-';
                info.push(`ML: ${awayML} / ${homeML}`);
            }

            if (game.status) {
                info.push(`Status: ${game.status.charAt(0).toUpperCase() + game.status.slice(1)}`);
            }

            return info.length > 0 ? `
                <div class="game-info">
                    <div class="betting-info">
                        ${info.map(item => `<span>${item}</span>`).join('')}
                    </div>
                </div>
            ` : '';
        }

        function formatTime(dateTimeString) {
            if (!dateTimeString) return 'TBD';
            
            try {
                const date = new Date(dateTimeString);
                return date.toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                });
            } catch (error) {
                return 'TBD';
            }
        }

        function formatDate(dateString) {
            try {
                const date = new Date(dateString + 'T00:00:00');
                return date.toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } catch (error) {
                return dateString;
            }
        }

        function formatGolfDate(dateString) {
            try {
                const date = new Date(dateString + 'T00:00:00');
                return date.toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric'
                });
            } catch (error) {
                return dateString;
            }
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function hideError() {
            document.getElementById('error').style.display = 'none';
        }

        function hideSchedule() {
            document.getElementById('scheduleContainer').style.display = 'none';
        }

        // Load today's MLB schedule by default
        fetchSchedule();
    </script>
</body>
</html>
