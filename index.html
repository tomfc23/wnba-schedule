<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WNBA 2025 Season Schedule (Wikipedia)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #eee;
      padding: 20px;
      margin: 0;
      min-height: 100vh;
    }
    h1 {
      color: #4CAF50;
    }
    #status {
      margin-top: 20px;
      font-size: 1.2em;
    }
    .error {
      color: #ff6c6c;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      background: #181818;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #444;
      padding: 12px;
      text-align: left;
    }
    th {
      background: #4CAF50;
      color: #fff;
      font-weight: bold;
    }
    tr:nth-child(even) {
      background: #222;
    }
    tr:hover {
      background: #333;
    }
  </style>
</head>
<body>
  <h1>WNBA 2025 Season Schedule (from Wikipedia) 5.1</h1>
  <div id="status">Loading schedule...</div>
  <table id="schedule-table" style="display:none;">
    <thead>
      <tr>
        <th>Date</th>
        <th>Time (ET)</th>
        <th>Matchup</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
function formatDate(dateStr) {
  // Convert various date formats to M/D/YY
  try {
    const date = new Date(dateStr);
    if (isNaN(date.getTime())) return dateStr;
    
    const month = date.getMonth() + 1;
    const day = date.getDate();
    const year = date.getFullYear().toString().slice(-2);
    
    return `${month}/${day}/${year}`;
  } catch (e) {
    return dateStr;
  }
}

function formatTime(timeStr) {
  // Keep time format clean with spaces
  return timeStr.trim();
}

function formatMatchup(matchupStr) {
  // Clean up matchup string and ensure proper format
  return matchupStr.replace(/\s+/g, ' ').trim();
}

async function fetchScheduleFromWikipedia() {
  const proxy = 'https://api.allorigins.win/raw?url=';
  const wikiURL = 'https://en.wikipedia.org/wiki/2025_WNBA_season';
  const statusDiv = document.getElementById('status');
  const table = document.getElementById('schedule-table');
  const tbody = table.querySelector('tbody');

  try {
    statusDiv.textContent = 'Loading schedule...';
    const response = await fetch(proxy + encodeURIComponent(wikiURL));
    if (!response.ok) throw new Error('Failed to fetch Wikipedia page.');

    const htmlText = await response.text();
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, 'text/html');

    // Find the appropriate table - try multiple approaches
    const tables = Array.from(doc.querySelectorAll('table.wikitable, table.sortable, table'));
    let scheduleTable = null;
    
    for (const t of tables) {
      const headers = Array.from(t.querySelectorAll('th')).map(th => th.textContent.trim().toLowerCase());
      if (headers.some(h => h.includes('date')) && 
          headers.some(h => h.includes('time')) && 
          headers.some(h => h.includes('matchup') || h.includes('game'))) {
        scheduleTable = t;
        break;
      }
    }
    
    if (!scheduleTable) {
      // Try to find any table with date-like content
      for (const t of tables) {
        const firstRow = t.querySelector('tr');
        if (firstRow && firstRow.textContent.toLowerCase().includes('date')) {
          scheduleTable = t;
          break;
        }
      }
    }
    
    if (!scheduleTable) throw new Error('Schedule table not found.');

    tbody.innerHTML = '';
    let lastDate = '';
    let lastTime = '';

    Array.from(scheduleTable.querySelectorAll('tr')).slice(1).forEach(row => {
      const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent.trim());
      if (cells.length === 0) return;

      // Handle full row (Date, Time, Matchup)
      if (cells.length >= 3 && cells[0] && cells[1] && cells[2]) {
        lastDate = formatDate(cells[0]);
        lastTime = formatTime(cells[1]);
        const matchup = formatMatchup(cells[2]);
        if (matchup) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${lastDate}</td><td>${lastTime}</td><td>${matchup}</td>`;
          tbody.appendChild(tr);
        }
      }

      // Handle row with blank date, but time and matchup present
      else if (cells.length >= 3 && !cells[0] && cells[1] && cells[2]) {
        lastTime = formatTime(cells[1]);
        const matchup = formatMatchup(cells[2]);
        if (matchup) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${lastDate}</td><td>${lastTime}</td><td>${matchup}</td>`;
          tbody.appendChild(tr);
        }
      }

      // Handle row with only matchup (e.g., "Phoenix", "@", "Las Vegas")
      else if (cells.length === 3 && cells[1] === '@') {
        const matchup = `${cells[0]} at ${cells[2]}`;
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${lastDate}</td><td>${lastTime}</td><td>${matchup}</td>`;
        tbody.appendChild(tr);
      }
      
      // Handle two-column format (Time, Matchup)
      else if (cells.length === 2 && cells[0] && cells[1]) {
        if (cells[0].includes(':')) {
          // First cell looks like time
          lastTime = formatTime(cells[0]);
          const matchup = formatMatchup(cells[1]);
          if (matchup) {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${lastDate}</td><td>${lastTime}</td><td>${matchup}</td>`;
            tbody.appendChild(tr);
          }
        }
      }
    });

    if (tbody.children.length === 0) {
      throw new Error('No schedule data found in the expected format.');
    }

    statusDiv.style.display = 'none';
    table.style.display = 'table';
    
  } catch (error) {
    statusDiv.innerHTML = `<span class="error">Error loading schedule: ${error.message}</span>`;
    table.style.display = 'none';
    console.error(error);
  }
}

fetchScheduleFromWikipedia();
</script>
</body>
</html>
