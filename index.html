<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WNBA 2025 Season Schedule (Wikipedia)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #eee;
      padding: 20px;
      margin: 0;
      min-height: 100vh;
    }
    h1 {
      color: #4CAF50;
    }
    #status {
      margin-top: 20px;
      font-size: 1.2em;
    }
    .error {
      color: #ff6c6c;
    }
    #output {
      background: #181818;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <h1>WNBA 2025 Season Schedule (from Wikipedia) 5.2</h1>
  <div id="status">Loading schedule...</div>
  <div id="output" style="display:none;"></div>

<script>
function formatDate(dateStr) {
  // Convert various date formats to M/D/YY
  try {
    const date = new Date(dateStr);
    if (isNaN(date.getTime())) return dateStr;
    
    const month = date.getMonth() + 1;
    const day = date.getDate();
    const year = date.getFullYear().toString().slice(-2);
    
    return `${month}/${day}/${year}`;
  } catch (e) {
    return dateStr;
  }
}

function formatTime(timeStr) {
  // Remove spaces and ensure AM/PM format
  return timeStr.replace(/\s+/g, '');
}

function formatMatchup(matchupStr) {
  // Clean up matchup string and ensure proper format
  return matchupStr.replace(/\s+/g, ' ').trim();
}

async function fetchScheduleFromWikipedia() {
  const proxy = 'https://api.allorigins.win/raw?url=';
  const wikiURL = 'https://en.wikipedia.org/wiki/2025_WNBA_season';
  const statusDiv = document.getElementById('status');
  const outputDiv = document.getElementById('output');

  try {
    statusDiv.textContent = 'Loading schedule...';
    const response = await fetch(proxy + encodeURIComponent(wikiURL));
    if (!response.ok) throw new Error('Failed to fetch Wikipedia page.');

    const htmlText = await response.text();
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, 'text/html');

    // Find the appropriate table - try multiple approaches
    const tables = Array.from(doc.querySelectorAll('table.wikitable, table.sortable, table'));
    let scheduleTable = null;
    
    for (const t of tables) {
      const headers = Array.from(t.querySelectorAll('th')).map(th => th.textContent.trim().toLowerCase());
      if (headers.some(h => h.includes('date')) && 
          headers.some(h => h.includes('time')) && 
          headers.some(h => h.includes('matchup') || h.includes('game'))) {
        scheduleTable = t;
        break;
      }
    }
    
    if (!scheduleTable) {
      // Try to find any table with date-like content
      for (const t of tables) {
        const firstRow = t.querySelector('tr');
        if (firstRow && firstRow.textContent.toLowerCase().includes('date')) {
          scheduleTable = t;
          break;
        }
      }
    }
    
    if (!scheduleTable) throw new Error('Schedule table not found.');

    let output = '';
    let lastDate = '';
    let lastTime = '';

    Array.from(scheduleTable.querySelectorAll('tr')).slice(1).forEach(row => {
      const cells = Array.from(row.querySelectorAll('td')).map(td => td.textContent.trim());
      if (cells.length === 0) return;

      // Handle full row (Date, Time, Matchup)
      if (cells.length >= 3 && cells[0] && cells[1] && cells[2]) {
        lastDate = formatDate(cells[0]);
        lastTime = formatTime(cells[1]);
        const matchup = formatMatchup(cells[2]);
        if (matchup) {
          output += `${lastDate}${lastTime}${matchup}`;
        }
      }

      // Handle row with blank date, but time and matchup present
      else if (cells.length >= 3 && !cells[0] && cells[1] && cells[2]) {
        lastTime = formatTime(cells[1]);
        const matchup = formatMatchup(cells[2]);
        if (matchup) {
          output += `${lastDate}${lastTime}${matchup}`;
        }
      }

      // Handle row with only matchup (e.g., "Phoenix", "@", "Las Vegas")
      else if (cells.length === 3 && cells[1] === '@') {
        const matchup = `${cells[0]} at ${cells[2]}`;
        output += `${lastDate}${lastTime}${matchup}`;
      }
      
      // Handle two-column format (Time, Matchup)
      else if (cells.length === 2 && cells[0] && cells[1]) {
        if (cells[0].includes(':')) {
          // First cell looks like time
          lastTime = formatTime(cells[0]);
          const matchup = formatMatchup(cells[1]);
          if (matchup) {
            output += `${lastDate}${lastTime}${matchup}`;
          }
        }
      }
    });

    if (output.trim() === '') {
      throw new Error('No schedule data found in the expected format.');
    }

    statusDiv.style.display = 'none';
    outputDiv.textContent = output;
    outputDiv.style.display = 'block';
    
  } catch (error) {
    statusDiv.innerHTML = `<span class="error">Error loading schedule: ${error.message}</span>`;
    outputDiv.style.display = 'none';
    console.error(error);
  }
}

fetchScheduleFromWikipedia();
</script>
</body>
</html>
