<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WNBA 2025 Season Schedule (Wikipedia)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #eee;
      padding: 20px;
      margin: 0;
      min-height: 100vh;
    }
    h1 {
      color: #4CAF50;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      background: #181818;
    }
    th, td {
      border: 1px solid #444;
      padding: 8px;
      text-align: left;
    }
    th {
      background: #4CAF50;
      color: #fff;
    }
    tr:nth-child(even) {
      background: #222;
    }
    #status {
      margin-top: 20px;
      font-size: 1.2em;
    }
    .error {
      color: #ff6c6c;
    }
  </style>
</head>
<body>
  <h1>WNBA 2025 Season Schedule (from Wikipedia) 4.0</h1>
  <div id="status">Loading schedule...</div>
  <table id="schedule-table" style="display:none;">
    <thead>
      <tr><th>Date</th><th>Time (ET)</th><th>Matchup</th></tr>
    </thead>
    <tbody></tbody>
  </table>
<script>
async function fetchScheduleFromWikipedia() {
  const proxy = 'https://api.allorigins.win/raw?url=';
  const wikiURL = 'https://en.wikipedia.org/wiki/2025_WNBA_season';
  const statusDiv = document.getElementById('status');
  const table = document.getElementById('schedule-table');
  const tbody = table.querySelector('tbody');

  try {
    statusDiv.textContent = 'Loading schedule...';
    const response = await fetch(proxy + encodeURIComponent(wikiURL));
    if (!response.ok) throw new Error('Failed to fetch Wikipedia page.');

    const htmlText = await response.text();
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, 'text/html');

    // Find the regular season table (adjust this if the structure changes)
    const tables = Array.from(doc.querySelectorAll('table.wikitable'));
    let scheduleTable = null;
    for (const t of tables) {
      const headers = Array.from(t.querySelectorAll('th')).map(th => th.textContent.trim().toLowerCase());
      if (headers.includes('date') && headers.includes('time (et)') && headers.includes('matchup')) {
        scheduleTable = t;
        break;
      }
    }
    if (!scheduleTable) throw new Error('Schedule table not found.');

    // Parse table rows
    tbody.innerHTML = '';
    let lastDate = '';
    Array.from(scheduleTable.querySelectorAll('tr')).slice(1).forEach(row => {
      const cells = Array.from(row.querySelectorAll('td'));
      if (cells.length < 3) return;

      // Date logic
      let date = cells[0].textContent.trim();
      if (date) lastDate = date;
      else date = lastDate;

      // Some rows have multiple games per date, with time & matchup but no date.
      let time = cells[1].textContent.trim();
      let matchup = cells[2].textContent.trim();

      // Some rows may have matchups split across 2-3 cells with "@" in the middle
      // e.g. [Chicago] [@] [Minnesota] => Chicago @ Minnesota
      if (matchup === '@' && cells[1].textContent.trim() && cells[3]) {
        matchup = `${cells[1].textContent.trim()} @ ${cells[3].textContent.trim()}`;
        time = ''; // No time in this pattern
      } else if (cells.length >= 4 && cells[3].textContent.trim() === '@') {
        // e.g. [Chicago] [@] [Minnesota] in cells 2,3,4
        matchup = `${cells[2].textContent.trim()} @ ${cells[4].textContent.trim()}`;
        time = cells[1].textContent.trim();
      } else if (cells.length >= 4 && cells[3].textContent.trim() && cells[2].textContent.trim() === '@') {
        matchup = `${cells[1].textContent.trim()} @ ${cells[3].textContent.trim()}`;
        time = '';
      }

      // Only output if we have at least date, and matchup or time
      if (date && (time || matchup)) {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${date}</td><td>${time}</td><td>${matchup}</td>`;
        tbody.appendChild(tr);
      }
    });

    statusDiv.style.display = 'none';
    table.style.display = 'table';
  } catch (error) {
    statusDiv.innerHTML = `<span class="error">Error loading schedule: ${error.message}</span>`;
    table.style.display = 'none';
    console.error(error);
  }
}

fetchScheduleFromWikipedia();
</script>
</body>
</html>
